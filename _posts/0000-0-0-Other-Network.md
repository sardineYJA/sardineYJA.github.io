---
layout: post
title: "网络通信知识"
date: 2018-08-11
description: "网络通信知识"
tag: Other

---

# 互联网的本质就是一系列的网络协议


## 互联网协议按照功能不同分为：

- tcp/ip四层：应用层、传输层、网络层、网络接口层
- tcp/ip五层：应用层、传输层、网络层、【数据链路层、物理层】
- osi七层：【应用层、表示层、会话层】、传输层、网络层、数据链路层、物理层


## 每层运行常见物理设备：

- 传输层     ————> 四层交换机、四层路由器
- 网络层     ————> 路由器、三层交换机
- 数据链路层 ————> 网桥、以太网交换机、网卡
- 物理层     ————> 中继器、集线器、双绞线


## 物理层：比特

主要是基于电器特性发送高低电压(电信号)，高电压对应数字1，低电压对应数字0


## 数据链路层：帧

数据链路层由来：单纯的电信号0和1没有任何意义，必须规定电信号多少位一组，每组什么意思

数据链路层的功能：定义了电信号的分组方式

早期以太网协议ethernet：数据帧 = head + data，
其中head = 发送者mac地址(6个字节) + 接收者mac地址(6个字节) + 数据类型(6个字节)

相关协议： PPP(Point-to-Ponit Protocol)点对点协议面向字节


## 网络层：数据报

网络层功能：引入一套新的地址用来区分不同的广播域／子网，这套地址即网络地址（IP协议）

ARP（Address Resolution Protocol）地址解析协议，根据IP地址获取物理地址mac的一个TCP/IP协议

RARP (Reverse Address Resolution Protocol)反向地址转换协议允许局域 网的物理机器从网关服务器的 ARP 表或者缓存上请求其 IP地址。 

ICMP (Internet Control Message Protocol ）Internet 控制报文协议。它是TCP/IP 协议族的一个子协议，用于在IP 主机、路由器之间传递控制消息

NAT（network address translation,网络地址转换协议）内网IP替换为当前局域网的对外外网IP

相关协议：IP，ARP，RARP，ICMP，ICGP


## 传输层：报文段

传输层的由来：网络层的ip帮我们区分子网，以太网层的mac帮我们找到主机，然后大家使用的都是应用程序，你的电脑上可能同时开启多个应用程序，如何标识这台主机上的应用程序，答案就是端口，端口即应用程序与网卡关联的编号。

传输层功能：建立端口到端口的通信。

相关协议：TCP，UDP


## 应用层：报文

应用层功能：规定应用程序的数据格式。

DHCP(Dynamic Host Configuration Protocol)动态主机分配协议，使用 UDP 协议工作，给内部网络或网络服务供应商自动分配 IP 地址。

相关协议：HTTP，FTP，DNS，DHCP






## 进程间通信

进程间通信（IPC，InterProcess Communication）是指在不同进程之间传播或交换信息。

IPC的方式通常有管道（包括无名管道和命名管道）、消息队列、信号量、共享存储、Socket、Streams等。其中 Socket和Streams支持不同主机上的两个进程IPC。

共享内存是最快的一种 IPC，因为进程是直接对内存进行存取。


## 请求连接

```
C   ------SYN----->  S
C   <---SYN,ACK----  S
C   ------ACK----->  S
```


## 断开连接

```
C   -----FIN----->  S
C   <-----ACK-----  S
C   <-----FIN-----  S
C   -----ACK----->  S
```


## 死锁4个必要条件

- 互斥：某资源一次只允许一个进程访问

- 占有且等待：一个进程占有资源但未满足条件，则等待

- 不可抢占：不可抢占其他进程资源

- 循环等待


## 解决死锁

- 破坏`占有且等待`：所有的进程在开始运行之前，必须一次性地申请其在整个运行过程中所需要的全部资源。

- 银行家算法

